(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,n){e.exports=n.p+"static/media/loading.e404159f.gif"},37:function(e,t,n){e.exports=n(65)},65:function(e,t,n){"use strict";n.r(t);var a,i,o,r,s,c,l,u,m,d,h,p=n(0),f=n.n(p),v=n(14),b=n.n(v),g=n(68),O=n(10),y=n(4),j=n(13),w=n(23),E=n(9),R=n(11),F=n(12),C=n(7),N=(n(43),n(2)),k=n(18),x=n(32),S=n.n(x),z=function(){var e=[.75,1,1,1.33];return{next:function(){return e[Math.floor(4*Math.random())]}}}(),M=(a=function(){function e(){Object(R.a)(this,e),Object(E.a)(this,"imageURLs",i,this),Object(E.a)(this,"placeholdersCount",o,this),Object(E.a)(this,"favourites",r,this),Object(E.a)(this,"setImageURLs",s,this),Object(E.a)(this,"addImageURLs",c,this),Object(E.a)(this,"setPlaceholdersCount",l,this),Object(E.a)(this,"setFavourites",u,this),Object(E.a)(this,"addToFavourites",m,this),Object(E.a)(this,"removeFromFavourites",d,this),Object(E.a)(this,"requestMoreImages",h,this)}return Object(F.a)(e,[{key:"images",get:function(){return Object(w.a)(this.imageURLs).concat(Object(w.a)(Object(k.b)(0,this.placeholdersCount).map(function(e){return{isPlaceholder:!0,placeholderHeightRatio:z.next()}})))}}]),e}(),i=Object(C.a)(a.prototype,"imageURLs",[N.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),o=Object(C.a)(a.prototype,"placeholdersCount",[N.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r=Object(C.a)(a.prototype,"favourites",[N.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new k.c(function(){var e=document.cookie.match(/favourite-shibe-dogs=([^;]*)/);return null!==e&&e.length>0?JSON.parse(e[1]):null}()||[])}}),s=Object(C.a)(a.prototype,"setImageURLs",[N.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.imageURLs.replace(t)}}}),c=Object(C.a)(a.prototype,"addImageURLs",[N.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n;(n=e.imageURLs).push.apply(n,Object(w.a)(t))}}}),l=Object(C.a)(a.prototype,"setPlaceholdersCount",[N.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.placeholdersCount=t}}}),u=Object(C.a)(a.prototype,"setFavourites",[N.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n;e.favourites=t,n=t,document.cookie="favourite-shibe-dogs=".concat(JSON.stringify(n))}}}),m=Object(C.a)(a.prototype,"addToFavourites",[N.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.setFavourites(e.favourites.add(t))}}}),d=Object(C.a)(a.prototype,"removeFromFavourites",[N.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.setFavourites(e.favourites.delete(t))}}}),Object(C.a)(a.prototype,"images",[N.e],Object.getOwnPropertyDescriptor(a.prototype,"images"),a.prototype),h=Object(C.a)(a.prototype,"requestMoreImages",[N.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.setPlaceholdersCount(e.placeholdersCount+t),function(e){return S.a.get("https://cors.io/?https://shibe.online/api/shibes?count=".concat(e))}(t).then(function(n){var a=n.data;e.setPlaceholdersCount(e.placeholdersCount-t),e.addImageURLs(a.map(function(e){return{url:e,isPlaceholder:!1,placeholderHeightRatio:z.next()}}))})}}}),a),L=n(69),I=n(67),H=n(66),T=n(70),W=Object(T.a)(Object(y.b)(function(e){return{favourites:e.appState.favourites}})(Object(y.c)(function(e){var t=e.location,n=e.favourites;return f.a.createElement("nav",{className:"navbar sticky-top navbar-light bg-light navbar-expand"},f.a.createElement("a",{className:"navbar-brand",href:"/"},"Infinite Scroll Demo"),f.a.createElement("div",{className:"collapse navbar-collapse"},f.a.createElement("ul",{className:"navbar-nav"},[{label:"New Photos",path:"/"},{label:"Favourites (".concat(n.size,")"),path:"/favourites"}].map(function(e){return f.a.createElement("li",{key:e.label,className:"nav-item ".concat(t.pathname===e.path&&"active")},f.a.createElement(H.a,{className:"nav-link",to:e.path},e.label))}))))}))),U=n(16),P=n(15),A=n(17);function q(){var e=Object(O.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n\n  .image {\n    opacity: 0;\n    position: absolute;\n  }\n\n  .image--loaded {\n    opacity: 1;\n    transition: opacity 0.5s;\n  }\n\n  .overlay {\n    position: absolute;\n    top: 50%;\n    width: 100%;\n    height: 40%;\n\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    opacity: 1;\n\n    background: rgba(255, 255, 255, 0.9);\n\n    transition: opacity 0.2s;\n    transform: translateY(-50%);\n  }\n\n  .overlay--hidden {\n    opacity: 0;\n  }\n\n  .primary-button--hidden {\n    display: none;\n  }\n\n  .message {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .message--hidden {\n    display: none;\n  }\n\n  .favourites-indicator {\n    position: absolute;\n    bottom: 12px;\n    right: 12px;\n    transition: opacity 0.5s 0.2s;\n  }\n\n  .favourites-indicator--hidden {\n    opacity: 0;\n  }\n"]);return q=function(){return e},e}var V=j.a.div(q()),B=function(e){function t(e){var n;return Object(R.a)(this,t),(n=Object(U.a)(this,Object(P.a)(t).call(this,e))).onMouseOver=function(){n.setState({mouseOver:!0})},n.onMouseOut=function(){n.state.message||n.setState({mouseOver:!1,message:"",undoVisible:!1,undoAction:null})},n.addToFavourites=function(){var e=n.imageRef.current;n.props.addToFavourites({url:n.props.image.url,placeholderHeightRatio:e.clientHeight/e.clientWidth}),n.setState({message:"Added to favourites!",undoAction:n.removeFromFavourites}),n.timer&&clearTimeout(n.timer),n.timer=setTimeout(function(){n.setState({mouseOver:!1,message:"",undoVisible:!1,undoAction:null,primaryButtonVisible:!1})},2e3)},n.removeFromFavourites=function(){var e=n.imageRef.current;n.props.removeFromFavourites({url:n.props.image.url,placeholderHeightRatio:e.clientHeight/e.clientWidth}),n.setState({message:"Removed from favourites.",undoAction:n.addToFavourites}),n.timer&&clearTimeout(n.timer),n.timer=setTimeout(function(){n.setState({mouseOver:!1,message:"",undoVisible:!1,undoAction:null,primaryButtonVisible:!1})},2e3)},n.state={mouseOver:!1,message:"",primaryButtonVisible:!1},n.imageRef=Object(p.createRef)(),n}return Object(A.a)(t,e),Object(F.a)(t,[{key:"onImageLoad",value:function(e){var t=e.target;t.classList.add("image--loaded"),t.parentNode.parentNode.style.height="".concat(t.clientHeight,"px")}},{key:"render",value:function(){var e=this.props,t=e.image,n=e.favourites,a=this.state.mouseOver,i=this.imageRef.current,o=n.includes({url:this.props.image.url,placeholderHeightRatio:i.clientHeight/i.clientWidth});return f.a.createElement(V,{onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},t.isPlaceholder?f.a.createElement("div",{className:"image-placeholder"}):f.a.createElement("img",{ref:this.imageRef,className:"image",alt:"Shibe dog",src:t.url,decoding:"async",onLoad:this.onImageLoad}),f.a.createElement("div",{className:"overlay ".concat(!a&&"overlay--hidden")},f.a.createElement("button",{type:"button",className:"btn btn-outline-primary primary-button ".concat(this.state.message&&"primary-button--hidden"),onClick:o?this.removeFromFavourites:this.addToFavourites},o?"\ud83d\udc94 Remove from Favourites":"\u2764\ufe0f Add to Favourites"),f.a.createElement("div",{className:"message ".concat(!this.state.message&&"message--hidden")},f.a.createElement("span",null,this.state.message),f.a.createElement("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:this.state.undoAction},"Undo"))),f.a.createElement("div",{className:"favourites-indicator ".concat(!o&&"favourites-indicator--hidden")},f.a.createElement("span",{role:"img","aria-label":"favourite"},"\u2764\ufe0f"),"\ufe0f"))}}]),t}(p.Component),J=Object(y.b)(function(e){var t=e.appState;return{favourites:t.favourites,addToFavourites:t.addToFavourites,removeFromFavourites:t.removeFromFavourites}})(Object(y.c)(B)),D=6,Y=300+2*D,$=n(35),G=n.n($);function K(){var e=Object(O.a)(["\n  .image-list--item {\n    background-image: url(",");\n    background-color: lightgray;\n    background-repeat: no-repeat;\n    background-position: center;\n    background-blend-mode: multiply;\n    \n    margin: ","px 0;\n    transition: height 0.2s;\n  }\n"]);return K=function(){return e},e}var Q=j.a.ul(K(),G.a,D),X=function(e){function t(){return Object(R.a)(this,t),Object(U.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(F.a)(t,[{key:"render",value:function(){var e=this.props,t=e.list,n=e.columnWidth;return f.a.createElement(Q,{className:"image-list"},t.map(function(e,t){return f.a.createElement("li",{className:"image-list--item",key:"".concat(e.url||"placeholder","-").concat(t),style:{height:n*e.placeholderHeightRatio}},f.a.createElement(J,{image:e}))}))}}]),t}(p.Component);function Z(){var e=Object(O.a)(["\n  .image-list-container {\n    display: flex;\n    justify-content: center;\n    align-items: flex-start;\n  }\n\n  .image-list {\n    list-style: none;\n    display: flex;\n    flex-direction: column;\n    flex-basis: 50%;\n    padding: 0;\n    margin: 0 ","px;\n  }\n\n  .image {\n    width: 100%;\n    object-fit: cover;\n  }\n\n  .image-placeholder {\n    width: 100%;\n    height: 100%;\n  }\n"]);return Z=function(){return e},e}var _=j.a.div(Z(),D),ee=function(e){function t(e){var n;return Object(R.a)(this,t),(n=Object(U.a)(this,Object(P.a)(t).call(this,e))).getMinColumnHeight=function(){var e=n.listContainerRef.current.childNodes;if(e&&e.length>0){for(var t=1/0,a=0;a<e.length;a++)t=Math.min(t,e[a].clientHeight);return t}return 0},n.onScroll=function(){var e=window.pageYOffset||document.documentElement.scrollTop;n.getMinColumnHeight()<window.innerHeight+e&&n.props.requestMoreImages(16)},n.onResize=function(){var e=Math.floor(n.listContainerRef.current.clientWidth/Y),t=n.listContainerRef.current.clientWidth/e-2*D;n.setState({columnsCount:e,actualColumnWidth:t})},n.listContainerRef=Object(p.createRef)(),n.state={initialized:!1,columnsCount:0,actualColumnWidth:0},n}return Object(A.a)(t,e),Object(F.a)(t,[{key:"componentDidMount",value:function(){this.state.initialized||(window.addEventListener("resize",this.onResize),this.onResize(),this.props.infinite&&(window.addEventListener("scroll",this.onScroll),this.onScroll()),this.setState({initialized:!0}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),this.props.infinite&&window.removeEventListener("scroll",this.onScroll)}},{key:"render",value:function(){var e=this.state,t=e.columnsCount,n=e.actualColumnWidth,a=this.props,i=a.images,o=a.title,r=Object(k.a)(Object(k.b)(0,t).map(function(e){return[]}));return t&&n&&i.forEach(function(e,n){r.get(n%t).push(e)}),f.a.createElement(_,null,f.a.createElement("div",{className:"row"},f.a.createElement("div",{className:"col"},f.a.createElement("h1",null,o))),f.a.createElement("div",{className:"row"},f.a.createElement("div",{className:"col image-list-container",ref:this.listContainerRef},r.map(function(e,a){return f.a.createElement(X,{key:"list-".concat(a,"-of-").concat(t),list:e,columnWidth:n})}))))}}]),t}(p.Component),te=Object(y.b)(function(e){var t=e.appState;return{images:t.images,requestMoreImages:t.requestMoreImages}})(Object(y.c)(function(e){var t=e.images,n=e.requestMoreImages;return f.a.createElement(ee,{infinite:!0,title:"New Photos",images:t,requestMoreImages:n})})),ne=Object(y.b)(function(e){return{favourites:e.appState.favourites}})(Object(y.c)(function(e){var t=e.favourites;return f.a.createElement(ee,{title:"Favourites",images:t.toJS()})}));function ae(){var e=Object(O.a)(["\n  .main {\n    padding-top: 56px;\n  }\n"]);return ae=function(){return e},e}var ie=j.a.div(ae()),oe=new M,re=function(){return f.a.createElement(y.a,{appState:oe},f.a.createElement(ie,{className:"App"},f.a.createElement(W,null),f.a.createElement("div",{className:"main container"},f.a.createElement(L.a,null,f.a.createElement(I.a,{exact:!0,path:"/",component:te}),f.a.createElement(I.a,{exact:!0,path:"/favourites",component:ne})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));b.a.render(f.a.createElement(g.a,{basename:"/infinite-scroll"},f.a.createElement(re,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[37,2,1]]]);
//# sourceMappingURL=main.329d7173.chunk.js.map